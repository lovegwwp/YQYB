<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.jyss.yqy.mapper.JBonusFxjMapper" >
  <resultMap id="BaseResultMap" type="com.jyss.yqy.entity.JBonusFxj" >
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="u_id" property="uId" jdbcType="INTEGER" />
    <result column="u_name" property="name" jdbcType="VARCHAR" />
    <result column="parent_id" property="parentId" jdbcType="INTEGER" />
    <result column="parent_money" property="amount" jdbcType="FLOAT" />
    <result column="status" property="status" jdbcType="TINYINT" />
    <result column="created" property="created" jdbcType="TIMESTAMP" />
  </resultMap>
 
  
  	<!-- 查询昨日个人列表详情 -->
	<select id="selectJBonusFxjByPid" parameterType="int" resultMap="BaseResultMap">
		select id,u_id,u_name,parent_id,parent_money,DATE_FORMAT(created, '%Y-%m-%d' ) created
		FROM j_bonus_fxj
		<where>
			<if test="parentId != null and parentId != ''">
				and parent_id = #{parentId,jdbcType=INTEGER}
			</if>
			and status = 1
			and to_days(now()) - to_days(created) = 1
		</where>
		order by created desc
	</select>
	
	<!-- 查询昨日个人列表总值 -->
	<select id="selectJBonusFxj" resultMap="BaseResultMap">
		SELECT id,u_id,u_name,parent_id,IFNULL(SUM(parent_money),0.00) parent_money
		FROM j_bonus_fxj
		where status = 1 and to_days(now()) - to_days(created) = 1
		group by parent_id
	</select>
 
 	<!-- 查询昨日总金额 -->
 	<select id="selectFxjTotal"  resultType="float">
		SELECT IFNULL(SUM(parent_money),0.00) parent_money
		FROM j_bonus_fxj
		where status = 1 and to_days(now()) - to_days(created) = 1
	</select>

	<!-- 查询本周个人列表总值 -->
	<!-- <select id="selectJBonusFxjWek" resultMap="BaseResultMap">
		SELECT id,u_id,u_name,parent_id,IFNULL(SUM(parent_money),0.00) amount
		FROM j_bonus_fxj
		where status = 1 and YEARWEEK(date_format(created,'%Y-%m-%d')) = YEARWEEK(now())
		group by parent_id
	</select> -->
	
	
	<!-- 按两个日期查询个人列表详情 -->
	<select id="selectJBonusFxjByPidAndDay"  resultMap="BaseResultMap">
		SELECT id,u_id,u_name,parent_id,parent_money,DATE_FORMAT(created, '%Y-%m-%d') created
		FROM j_bonus_fxj
		<where>
			<if test="parentId != null and parentId != ''">
				and parent_id = #{parentId,jdbcType=INTEGER}
			</if>
			<if test="beginTime != null and beginTime != ''">
				and date_format(created, '%Y-%m-%d') &gt;= #{beginTime}
			</if>
			<if test="endTime != null and endTime != ''">
				and date_format(created, '%Y-%m-%d') &lt;= #{endTime}
			</if>
			and status = 1 
		</where>
		order by created desc
	</select>
	
	<!-- 按两个日期查询个人列表总值 -->
	<select id="selectJBonusFxjByDay"  resultMap="BaseResultMap">
		SELECT id,u_id,u_name,parent_id,IFNULL(SUM(parent_money),0.00) parent_money
		FROM j_bonus_fxj
		<where>
			<if test="beginTime != null and beginTime != ''">
				and date_format(created, '%Y-%m-%d') &gt;= #{beginTime}
			</if>
			<if test="endTime != null and endTime != ''">
				and date_format(created, '%Y-%m-%d') &lt;= #{endTime}
			</if>
			and status = 1 
		</where>
		group by parent_id
	</select>
	
	<!-- 按两个日期查询总收益 -->
	<select id="selectFxjTotalByDay"  resultType="float">
		SELECT IFNULL(SUM(parent_money),0.00) parent_money
		FROM j_bonus_fxj
		<where>
			<if test="beginTime != null and beginTime != ''">
				and date_format(created, '%Y-%m-%d') &gt;= #{beginTime}
			</if>
			<if test="endTime != null and endTime != ''">
				and date_format(created, '%Y-%m-%d') &lt;= #{endTime}
			</if>
			AND status = 1 
		</where>
	</select>
	
	
	<!-- 按月查询 -->
	<!-- <select id="selectJBonusFxjByMonth"  resultMap="BaseResultMap">
		SELECT u_name,parent_money,DATE_FORMAT(created, '%Y-%m-%d' ) created
		FROM
		j_bonus_fxj
		<where>
			<if test="parentId != null and parentId != ''">
				and parent_id = #{parentId,jdbcType=INTEGER}
			</if>
			<if test="month != null and month != ''">
				and date_format(created, '%Y-%m') = #{month}
			</if>
			AND status = 1 
		</where>
		ORDER BY  created DESC
	</select> -->
	
	<!-- 按月查询总收益 -->
	<!-- <select id="selectFxjTotalByMonth"  resultType="float">
		SELECT IFNULL(SUM(parent_money),0.00)
		FROM
		j_bonus_fxj
		<where>
			<if test="parentId != null and parentId != ''">
				and parent_id = #{parentId,jdbcType=INTEGER}
			</if>
			<if test="month != null and month != ''">
				and date_format(created, '%Y-%m') = #{month}
			</if>
			AND status = 1 
		</where>
		ORDER BY  created DESC
	</select> -->
	
	
	
</mapper>